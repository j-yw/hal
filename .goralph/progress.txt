# Ralph Progress Log

## Codebase Patterns
- Type packages use simple Go structs with JSON tags for serialization
- Constants for enum-like values are defined as package-level `const` blocks
- Package organization follows internal/{domain}/types.go pattern
- Config loading uses gopkg.in/yaml.v3 with default fallback pattern
- Use DefaultXXX() functions to provide sensible defaults when config is missing

---

## 2026-01-30 - T-001
- Implemented compound types package at internal/compound/types.go
- Created AnalysisResult struct with PriorityItem, Description, Rationale, AcceptanceCriteria, EstimatedTasks, BranchName
- Created PipelineState struct with Step, BranchName, ReportPath, PRDPath, StartedAt, Analysis
- Added Step constants: StepAnalyze, StepBranch, StepPRD, StepExplode, StepLoop, StepPR
- Files changed: internal/compound/types.go (new)
- **Learnings for future iterations:**
  - Follow existing type patterns from internal/engine/prd.go
  - Use `omitempty` JSON tag for optional pointer fields
  - Constants provide type safety for step values
---

## 2026-01-30 - T-002
- Created compound config loader at internal/compound/config.go
- Created AutoConfig struct with ReportsDir, BranchPrefix, QualityChecks, MaxIterations
- Implemented LoadConfig(dir string) that reads from .goralph/config.yaml
- Added DefaultAutoConfig() with sensible defaults: reportsDir: .goralph/reports, branchPrefix: compound/, maxIterations: 25
- Added gopkg.in/yaml.v3 dependency
- Files changed: internal/compound/config.go (new), go.mod, go.sum
- **Learnings for future iterations:**
  - Use yaml.v3 for YAML parsing in Go
  - Merge pattern: load defaults first, then override with config values
  - Config struct can contain nested sections (Config.Auto for auto-specific settings)
---

## 2026-01-30 - T-003
- Created default config.yaml template at internal/template/config.yaml
- Template includes all settings: engine, maxIterations, retryDelay, maxRetries
- Template includes auto section: reportsDir, branchPrefix, qualityChecks, maxIterations
- All settings have descriptive comments explaining their purpose and defaults
- Embedded config.yaml in template.go using //go:embed
- Added config.yaml to DefaultFiles() map so init command will install it
- Files changed: internal/template/config.yaml (new), internal/template/template.go
- **Learnings for future iterations:**
  - Template files use //go:embed directive with matching variable names (DefaultConfig for config.yaml)
  - DefaultFiles() map controls which files goralph init creates
  - YAML comments with section separators improve readability of config files
---

## 2026-01-30 - T-004
- Updated init command to create config.yaml and reports directory
- goralph init now creates .goralph/config.yaml if it doesn't exist (already handled by DefaultFiles() from T-003)
- goralph init now creates .goralph/reports/ directory with .gitkeep
- Updated command Long description to document config.yaml and reports/ directory
- Files changed: cmd/init.go
- **Learnings for future iterations:**
  - Init command uses os.MkdirAll for idempotent directory creation
  - .gitkeep files ensure empty directories are tracked by git
  - DefaultFiles() already handles file creation/preservation logic - just add to the map
---

## 2026-01-30 - T-005
- Created autospec skill for autonomous PRD generation at internal/skills/autospec/SKILL.md
- Skill self-clarifies using analysis context (no user questions) for auto pipeline use
- Uses T-XXX task IDs (not US-XXX) for compound engineering format
- Includes boolean acceptance criteria patterns for autonomous verification
- Updated embed.go to include autospec in SkillContent map and SkillNames slice
- Files changed: internal/skills/autospec/SKILL.md (new), internal/skills/embed.go
- **Learnings for future iterations:**
  - Skills use //go:embed with matching variable name convention (e.g., autospecSkillContent)
  - SkillContent map and SkillNames slice must both be updated when adding new skills
  - Skill frontmatter uses YAML format with name and description fields
  - Autonomous skills should avoid interactive elements like AskUserQuestion
---

## 2026-01-30 - T-006
- Created explode skill for task breakdown at internal/skills/explode/SKILL.md
- Skill breaks down PRDs into 8-15 granular tasks for autonomous execution
- Uses T-XXX task IDs and outputs to .goralph/prd.json in userStories format
- Documents task sizing (one iteration rule), dependency ordering, and boolean acceptance criteria
- Updated embed.go to include explode in SkillContent map and SkillNames slice
- Files changed: internal/skills/explode/SKILL.md (new), internal/skills/embed.go
- **Learnings for future iterations:**
  - Skill pattern consistent: YAML frontmatter + markdown body + examples
  - Task count 8-15 is calibrated for context window limits
  - Standard ordering: investigation -> schema -> backend -> UI -> verification
  - Use userStories field (not tasks) for backward compatibility with existing Ralph loop
---

## 2026-01-30 - T-007
- Verified T-007 acceptance criteria - all work already completed during T-005 and T-006
- embed.go already has //go:embed for autospec/SKILL.md and explode/SKILL.md
- SkillContent map already contains autospec and explode entries
- SkillNames slice already contains "autospec" and "explode"
- Typecheck passed (go vet ./...)
- Tests passed (go test ./internal/skills/... - no test files, no failures)
- Files changed: .goralph/prd.json (marked T-007 as passes: true)
- **Learnings for future iterations:**
  - When implementing skills (T-005, T-006), embed.go updates are best done in the same PR
  - Check if earlier stories already completed dependent work before implementing
---

