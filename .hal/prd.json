{
  "project": "Hal",
  "branchName": "hal/goreleaser-cicd",
  "description": "GoReleaser CI/CD and Homebrew Release Pipeline - Automated cross-platform releases using GoReleaser v2, GitHub Actions, and a Homebrew tap",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create GoReleaser v2 configuration",
      "description": "As a developer, I want a .goreleaser.yaml config file so that GoReleaser can build cross-platform binaries, generate changelogs, create GitHub releases, and push a Homebrew formula.",
      "acceptanceCriteria": [
        ".goreleaser.yaml exists at the repo root with version: 2",
        "project_name is 'hal'",
        "before.hooks runs 'go mod tidy' and 'go vet ./...'",
        "Build config: CGO_ENABLED=0, targets linux/amd64, linux/arm64, darwin/amd64, darwin/arm64, windows/amd64",
        "Ldflags set -s -w and inject Version, Commit, BuildDate into github.com/jywlabs/hal/cmd",
        "Archives use tar.gz by default, zip for Windows, name template: {{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}",
        "Checksum file generated as checksums.txt using sha256",
        "Changelog sorted ascending, uses GitHub, excludes docs:/test:/chore:/ci: commits, groups by Features/Bug Fixes/Refactoring/Others",
        "Release targets j-yw/goralph, draft false, prerelease auto, name template 'Hal v{{ .Version }}'",
        "Brews section: formula name 'hal', pushes to j-yw/homebrew-tap using HOMEBREW_TAP_TOKEN env, directory Formula, includes install and test blocks",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Create release GitHub Actions workflow",
      "description": "As a developer, I want a GitHub Actions workflow that triggers on version tag pushes so that releases are fully automated.",
      "acceptanceCriteria": [
        ".github/workflows/release.yml exists",
        "Triggers on push of tags matching v*",
        "Sets permissions: contents: write",
        "Uses actions/checkout@v4 with fetch-depth: 0",
        "Uses actions/setup-go@v5 with go-version-file: go.mod",
        "Runs 'go test -v ./...' before releasing (tests gate the release)",
        "Uses goreleaser/goreleaser-action@v6 with version '~> v2' and args 'release --clean'",
        "Passes GITHUB_TOKEN and HOMEBREW_TAP_TOKEN as env vars to GoReleaser step",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Create CI GitHub Actions workflow",
      "description": "As a developer, I want a CI workflow that runs tests and validates GoReleaser config on pushes and PRs so that I catch issues before merging.",
      "acceptanceCriteria": [
        ".github/workflows/ci.yml exists",
        "Triggers on push to main and develop branches, and on PRs to main",
        "Contains a 'test' job that checks out code, sets up Go from go.mod, runs 'go vet ./...', runs 'go test -v ./...'",
        "Contains a 'goreleaser-check' job that checks out code with fetch-depth: 0, sets up Go from go.mod, runs goreleaser check via goreleaser/goreleaser-action@v6",
        "Both jobs run on ubuntu-latest",
        "Both jobs run in parallel (no dependency between them)",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Update .gitignore for GoReleaser dist output",
      "description": "As a developer, I want dist/ ignored by git so that local GoReleaser dry-run output is not accidentally committed.",
      "acceptanceCriteria": [
        ".gitignore contains dist/ entry",
        "Entry is in the binaries/build-artifacts section of the file",
        "Existing entries are unchanged",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Add release Makefile targets",
      "description": "As a developer, I want make release-dry-run and make release-check targets so that I can test releases locally before pushing tags.",
      "acceptanceCriteria": [
        "release-dry-run target runs 'goreleaser release --snapshot --clean'",
        "release-check target runs 'goreleaser check'",
        "Both targets are listed in the .PHONY line",
        "Both targets are documented in the help target output",
        "Existing Makefile targets and behavior are unchanged",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Verify end-to-end release pipeline locally",
      "description": "As a developer, I want to verify the full pipeline works by running a local dry-run and checking all expected artifacts are produced.",
      "acceptanceCriteria": [
        "make release-check exits 0 (config is valid)",
        "make release-dry-run exits 0 (snapshot build succeeds)",
        "dist/ directory contains 5 archive files matching hal_*_linux_amd64.tar.gz, hal_*_linux_arm64.tar.gz, hal_*_darwin_amd64.tar.gz, hal_*_darwin_arm64.tar.gz, hal_*_windows_amd64.zip",
        "dist/ contains checksums.txt with sha256 hashes for all 5 archives",
        "Each archive contains a hal binary (or hal.exe for Windows)",
        "make test and make vet still pass (no regressions)",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": ""
    }
  ]
}
